# í´ë¡œì € (Closure)

## 1ï¸âƒ£ í•µì‹¬ ê°œë…: í´ë¡œì €ë€?
### ğŸ”¹ ì •ì˜
> **í´ë¡œì €(Closure)** ëŠ” **í•¨ìˆ˜**ì™€ **ê·¸ í•¨ìˆ˜ê°€ ì„ ì–¸ë  ë‹¹ì‹œì˜ ë ‰ì‹œì»¬ í™˜ê²½(Lexical Environment)** ì˜ ì¡°í•©ì…ë‹ˆë‹¤. 
ì¦‰, í´ë¡œì €ëŠ” í•¨ìˆ˜ê°€ ì™¸ë¶€ ìŠ¤ì½”í”„ì— ìˆëŠ” ë³€ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

- í•¨ìˆ˜ëŠ” **ì„ ì–¸ëœ ìœ„ì¹˜**ì˜ ìŠ¤ì½”í”„ë¥¼ **ê¸°ì–µ**í•©ë‹ˆë‹¤.
- ê·¸ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ëŠ” ê·¸ ìŠ¤ì½”í”„ë¥¼ ì°¸ì¡°í•˜ëŠ” í•¨ìˆ˜ (í´ë¡œì €)ê°€ **ë„ë‹¬ ê°€ëŠ¥(reacheable)** í•œ ë™ì•ˆ **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ëŒ€ìƒì´ ì•„ë‹™ë‹ˆë‹¤**
- "ë©”ëª¨ë¦¬ì— ì˜ì›íˆ ë‚¨ëŠ”ë‹¤"ê°€ ì•„ë‹ˆë¼, **ì°¸ì¡°ê°€ ë‚¨ì•„ìˆì„ ë•Œë§Œ** ìœ ì§€ë©ë‹ˆë‹¤.

#### ğŸ§  ë‚´ë¶€ ë™ì‘(ê°„ë‹¨ ë²„ì „)
- ì—”ì§„ì€ í•¨ìˆ˜ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ **í™˜ê²½ ë ˆì½”ë“œ (Environment Record)**ë¥¼ ë¬¶ìŠµë‹ˆë‹¤.
- ì´ ë ˆì½”ë“œëŠ” **ìŠ¤ì½”í”„ ì²´ì¸**ì˜ í•œ ê³ ë¦¬ë¡œ ë‚¨ê³ , **í•¨ìˆ˜ ê°ì²´ì˜ ìˆ¨ì€ ìŠ¬ë¡¯([[Scopes]])ì„ í†µí•´ ì°¸ì¡°ë©ë‹ˆë‹¤.
- ë‚´ë¶€ í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œ í•´ë‹¹ ì²´ì¸ì„ ê±°ìŠ¬ë¡œ ì˜¬ë¼ê°€ **ììœ  ë³€ìˆ˜(ì™¸ë¶€ ë³€ìˆ˜)**ë¥¼ ì°¾ìŠµë‹ˆë‹¤.

### ğŸ§ ê°„ë‹¨í•œ ì˜ˆì‹œ
```js
function outer() {
    let count = 0;

    function inner() {
        count++;
        console.log(count);
    }

    return inner;
}

const counter = outer();
counter(); // 1
counter(); // 2
```
- `outer()` í˜¸ì¶œ ì‹œ `count`ê°€ ìƒì„±ë˜ê³ , `inner`ëŠ” `count`ê°€ ìˆëŠ” ë ‰ì‹œì»¬ í™˜ê²½ì„ **ìº¡ì²˜**í•©ë‹ˆë‹¤.
- `outer`ëŠ” ëë‚¬ì§€ë§Œ `counter`ê°€ ì‚´ì•„ìˆìœ¼ë¯€ë¡œ `count`ë„ ì‚´ì•„ ìˆìŠµë‹ˆë‹¤. **â†’ í´ë¡œì € íš¨ê³¼**

---

## 2ï¸âƒ£ ë‹¤ì–‘í•œ ì˜ˆì œì™€ í•´ì„¤
### ğŸ§ ì˜ˆì œ 1: ì—¬ëŸ¬ ê°œì˜ í´ë¡œì € ì¸ìŠ¤í„´ìŠ¤
```js
function createCounter() {
  let count = 0;
  return function () {
    count++;
    return count;
  };
}

const counter1 = createCounter();
const counter2 = createCounter();

console.log(counter1()); // 1
console.log(counter1()); // 2
console.log(counter2()); // 11
```
- `counter1`ê³¼ `counter2`ëŠ” ê°ì **ë‹¤ë¥¸ ë ‰ì‹œì»¬ í™˜ê²½**ì„ ê°€ì§‘ë‹ˆë‹¤.

---

### ğŸ§ ì˜ˆì œ 2: íŒŒë¼ë¯¸í„° ìº¡ì²˜ (ì»¤ë§/ë¶€ë¶„ ì ìš©)
```js
function makeMultiplier(multiplier) {
  return function (number) {
    return number * multiplier;
  };
}

const double = makeMultiplier(2);
const triple = makeMultiplier(3);

console.log(double(5)); // 10
console.log(triple(5)); // 15
```
- ë§¤ê°œë³€ìˆ˜ `multiplier`ëŠ” **ì™¸ë¶€ ìŠ¤ì½”í”„ ë³€ìˆ˜**ë¡œ **ìº¡ì²˜**ë˜ì–´ ì´í›„ì—ë„ ì‚¬ìš©ë©ë‹ˆë‹¤.

---

### ğŸ§ ì˜ˆì œ 3: ë£¨í”„ì™€ í´ë¡œì €(ê³ ì „ í•¨ì •)
```js
var funcs = [];

for (var i = 0; i < 3; i++) {
  funcs.push(function () {
    console.log(i);
  });
}

funcs[0](); // 3
funcs[1](); // 3
funcs[2](); // 3
```
- `var`ëŠ” **í•¨ìˆ˜ ìŠ¤ì½”í”„**ë¼ì„œ, ë£¨í”„ ì¢…ë£Œ í›„ì˜ `i(=3)`ë¥¼ ëª¨ë‘ ì°¸ì¡°í•©ë‹ˆë‹¤.

#### âœ… í•´ê²° 1: `let` ì‚¬ìš©(ë¸”ë¡ ìŠ¤ì½”í”„)
```js
const funcs = [];
for (let i = 0; i < 3; i++) {
  funcs.push(function () {
    console.log(i);
  });
}
funcs[0](); // 0
funcs[1](); // 1
funcs[2](); // 2
```

#### âœ… í•´ê²° 2: IIFE(ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜)ë¡œ ìŠ¤ëƒ…ìƒ· ìº¡ì²˜
```js
const funcs = [];
for (var i = 0; i < 3; i++) {
  (function (snapshot) {
    funcs.push(function () {
      console.log(snapshot);
    });
  })(i);
}
```
- IIFFë¡œ **ë§¤ ë°˜ë³µë§ˆë‹¤ ìƒˆë¡œìš´ ìŠ¤ì½”í”„**ì™€ **ë³„ë„ì˜ snapshot** ë§¤ê°œë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë¬¸ì œ í•´ê²°

---

## 3ï¸âƒ£ ì‹¤ì „ í™œìš© íŒ¨í„´
### ğŸ”¹ ë°ì´í„° ì€ë‹‰(ìº¡ìŠí™”)
```js
function createBankAccount(initialBalance) {
  let balance = initialBalance;

  return {
    deposit(amount) {
      balance += amount;
      return balance;
    },
    withdraw(amount) {
      balance -= amount;
      return balance;
    },
    getBalance() {
      return balance;
    },
  };
}

const account = createBankAccount(1000);
account.deposit(500);
console.log(account.getBalance()); // 1500
```
- `balance`**ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€.** ê³µê°œ APIë¡œë§Œ ì¡°ì‘ â†’ ì•ˆì „í•œ ìƒíƒœ ê´€ë¦¬

---

### ğŸ”¹ once() í•¨ìˆ˜
```js
function once(fn) {
  let called = false;
  let result;

  return function (...args) {
    if (!called) {
      called = true;
      result = fn.apply(this, args); // this/args ë³´ì¡´
    }
    return result;
  };
}

const init = once(() => console.log("Initialized"));
init(); // Initialized
init(); // (ì•„ë¬´ ì¼ ì—†ìŒ)
```

---
