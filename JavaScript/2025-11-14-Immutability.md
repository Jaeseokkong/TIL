# 🗿 Immutability

## 1️⃣ 불변성이란?

**불변성(Immutability)** 은 "값을 변경하지 않는다"는 개념이 아닙니다.  
정확히는 **기존 값으 수정하는 대신, 변경된 값은 담는 새로운 데이터를 만든다**라는 의미입니다.

- ❌ “데이터를 바꾼다”
- ✅ “바뀐 내용을 가진 새 데이터를 만든다”

이 방식은 코드의 예측 가능성을 높이고, 버그를 줄이며, 상태 변화의 추적을 용이하게 합니다.

---

## 2️⃣ 변수 이름의 불변성 : const vs var

- **변수명(identifier)은 메모리 주소를 가리키느 '라벨'**
- const는 "값이 불변"이 아니라 **라벨이 가리키는 주소가 불변**이라는 의미

### 🧐 예시
```js
var x = 10;
x = 20; // O, 재할당 가능

const y = 10;
y = 20; // ❌ TypeError: Assignment to constant variable.
```

### 🧭 메모리 도식

```css
# var
x ─> ┌────┐
     │ 10 │
     └────┘
x 재할당
x ─> ┌────┐
     │ 20 │
     └────┘

# const
y ─> ┌────┐
     │ 10 │
     └────┘
y = 20 (불가능)
```

---

## 2️⃣ 변수 할당 방식: Primitive vs Reference

JavaSript의 값은 두 가지 방식으로 저장됩니다.

| 구분        | 저장 방식     | 예시                      |
| --------- | --------- | ----------------------- |
| Primitive | 값 자체 저장   | number, string, boolean... |
| Reference | 메모리 주소 저장 | object, array, function |

### 🧐 Primitive 예시

```js
let a = 10;
let b = a;
a = 20;
```

### 🧭 메모리 도식

```css
a ─┐
   ▼
┌────┐
│ 10 │
└────┘
   ▲
b ─┘

a = 20 이후
a ─> ┌────┐
     │ 20 │
     └────┘
b ─> ┌────┐
     │ 10 │
     └────┘
```

---

## 3️⃣ 초기값 비교: === 의 동작 원리

### 🔹 Primitive 비교는 “값 비교”

```js
10 === 10; // true
"abc" === "abc" // true
```

### 🔹 Reference 비교는 “주소 비교”

```js
{} === {} // false (다른 주소)
[] === [] // false

// obj1 ─> [0x01]
// obj2 ─> [0x02]
// obj1 !== obj2
```

---

## 4️⃣ 객체의 가변성 (Mutability)

객체는 주소를 공유하기 때문에 변경하면 모든 참조에서 값이 바뀝니다.

### 🧐 예시

```js
const a = { value: 10 };
const b = a;

b.value = 20;

console.log(a.value); // 20
```

### 🧭 메모리 도식

```css
a ┐
  ▼
┌──────────────┐
│ { value:10 } │
└──────────────┘
  ▲     
b ┘

# b.value에 20 할당 이후
a ┐
  ▼
┌──────────────┐
│ { value:20 } │
└──────────────┘
  ▲     
b ┘
```

---

## 5️⃣ 객체의 복사 (Shallow Copy)

최상위 값만 새 객체에 복사하고 내부 중첩 객체는 **같은 주소를 공유**합니다.

### 🧐 예시

```js
const user = {
  name: "Lee",
  pet: { type: "cat" }
};

const copy = { ...user };
copy.pet.type = "dog";

console.log(user.pet.type); // "dog"
```

### 🧭 메모리 도식

```css
user ───────────┐
                ▼
        ┌──────────────────────┐
        │ name: "Lee"          │
        │ pet ─────────────┐   │
        └──────────────────────┘
                             │
                             │ 동일한 pet 주소
                             ▼
                    ┌──────────────────────────┐
                    │ { type: "cat" -> "dog" } │
                    └──────────────────────────┘
                             ▲
                             │ 동일한 pet 주소
        ┌──────────────────────┐
        │ name: "Lee"          │
        │ pet ─────────────┘   │
        └──────────────────────┘
                ▲
copy ───────────┘
```

- 얕은 복사는 **겉 객체만 새로 만들고**, 내부에 포함된 객체(`pet`)는 **같은 메모리 주소를 공유**
- 따라서, `copy.pet`을 수정하면, `user.pet`도 같은 객체를 가리키고 있기 때문에 함께 변경