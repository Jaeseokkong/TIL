# ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
## 1ï¸âƒ£ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œëž€?
ë¦¬ì„œí”„ í”„ë¡ì‹œëŠ” **í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ëŒ€ì‹  ë°›ì•„ì„œ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ë‹¬í•˜ê³ , ì‘ë‹µì„ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜í•˜ëŠ” ì—­í• **ì„ í•˜ëŠ” ì„œë²„ìž…ë‹ˆë‹¤.

### ðŸ”¹ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œì˜ ìž¥ì 
- ë³´ì•ˆ ê°•í™” (ë°±ì—”ë“œ ì„œë²„ë¥¼ ì™¸ë¶€ì— ì§ì ‘ ë…¸ì¶œí•˜ì§€ ì•ŠìŒ)
- ë¡œë“œ ë°¸ëŸ°ì‹± ê°€ëŠ¥
- SSL ì¢…ë£Œ(Offloading)ì§€ì›
- ìºì‹±ì„ í™œìš©í•œ ì„±ëŠ¥ ìµœì í™”
---

## 2ï¸âƒ£ `proxy_pass`ë¥¼ í™œìš©í•œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •
`proxy_pass` ì§€ì‹œì–´ë¥¼ ì‚¬ìš©í•˜ë©´ NGINXê°€ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ë‹¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
### ðŸ”¹ ê¸°ë³¸ ì„¤ì • ì˜ˆì œ
ì•„ëž˜ ì„¤ì •ì€ `http://localhost:3000`ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ Node.js ë°±ì—”ë“œ ì„œë²„ë¡œ ìš”ì²­ì„ ì „ë‹¬í•˜ëŠ” ì˜ˆì œìž…ë‹ˆë‹¤.
```nginx
server {
  listen: 80;
  server_name example.com;

  location /api/ {
    proxy_pass http://localhost:3000/;
  }
}
```
âœ”ï¸ `/api/`ë¡œ ì‹œìž‘í•˜ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ `http://localhost:3000/`ìœ¼ë¡œ ì „ë‹¬
---

## 3ï¸âƒ£ `proxy_set_header`, `X-Forwarded-For` ê°œë… ì´í•´
### ðŸ”¹ proxy_set_header
NGINXê°€ ë°±ì—”ë“œ ì„œë²„ë¡œ ìš”ì²­ì„ ì „ë‹¬í•  ë•Œ, íŠ¹ì • HTTP í—¤ë” ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ ë³€ê²½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
```nginx
location /api/ {
  proxy_pass http://localhost:3000/;
  proxy_set_header Host $host;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
}
```
### ðŸ”¹ X-Forwarded-For í—¤ë”
- ì›ëž˜ í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†Œë¥¼ ë³´ì¡´í•˜ëŠ” ì—­í• ì„ í•¨
- ê¸°ë³¸ì ìœ¼ë¡œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ê±°ì¹˜ë©´ ë°±ì—”ë“œ ì„œë²„ì—ì„œ `remote_addr` ê°’ì´ NGINXì˜ IPë¡œ ì„¤ì •ë¨
- ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `X-Forwarded-For` í—¤ë”ë¥¼ ì‚¬ìš©í•˜ë©´ ë°±ì—”ë“œì—ì„œ ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ IPë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŒ

#### ðŸ§ ì˜ˆì œ: ë°±ì—”ë“œì—ì„œ í´ë¼ì´ì–¸íŠ¸ IP í™•ì¸í•˜ê¸°
```js
app.get('/', (req, res) => {
    const clientIp = req.headers['x-forwarded-for'] || req.connection.remoteAddress;
    res.send(`Client IP: ${clientIp}`);
});
```