# `useActionState`
## 1οΈβƒ£ `useActionState`λ€?
`useActionState`λ” Next.js 13μ—μ„ λ„μ…λ **μ„λ²„ μ•΅μ… ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‚¬μ©ν•  μ μλ„λ΅ λ„μ™€μ£Όλ” ν›…**μ…λ‹λ‹¤. μ΄ ν›…μ€ **μ„λ²„μ—μ„ μ‹¤ν–‰λλ” λΉ„λ™κΈ° μ‘μ—…**μ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‰½κ² μ‹¤ν–‰ν•κ³ , κ·Έ μƒνƒλ¥Ό ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ— **λ™κΈ°ν™”**ν•  μ μκ² ν•΄μ¤λ‹λ‹¤. `useActionState`λ¥Ό μ‚¬μ©ν•λ©΄ **νΌ μƒνƒ κ΄€λ¦¬**λΏλ§ μ•„λ‹λΌ, **μ„λ²„ μ•΅μ…**μ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μƒνƒλ¥Ό ν¨μ¨μ μΌλ΅ λ™κΈ°ν™”ν•  μ μμµλ‹λ‹¤.

<br>

- - -

<br>

## 2οΈβƒ£ `useActionState` vs κΈ°μ΅΄ μƒνƒ κ΄€λ¦¬
### π”Ή μΌλ°μ μΈ React μƒνƒ κ΄€λ¦¬ (`useState`, `useReducer`) 
μΌλ°μ μΌλ΅ **React**μ—μ„λ” μƒνƒ κ΄€λ¦¬μ™€ μ„λ²„μ™€μ μƒνΈμ‘μ©μ„ **μλ™μΌλ΅ μ²λ¦¬**ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μ„λ²„μ— λ°μ΄ν„°λ¥Ό μ μ¶ν•κ±°λ‚ λ³€κ²½ν•λ ¤λ©΄, **API νΈμ¶**μ„ ν†µν•΄ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚΄κ³ , μ‘λ‹µμ„ λ°›μ€ ν›„ **ν΄λΌμ΄μ–ΈνΈ μƒνƒ**λ¥Ό μ—…λ°μ΄νΈ ν•©λ‹λ‹¤. 
μ΄ κ³Όμ •μ—μ„λ” μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ **μƒνƒ λ™κΈ°ν™”**κ°€ λ³µμ΅ν•κ³ , μ—¬λ¬ λ²μ μƒνƒ μ—…λ°μ΄νΈκ°€ ν•„μ”ν•©λ‹λ‹¤.

#### π§ μμ‹: κΈ°μ΅΄ λ°©μ‹μ—μ„μ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ μƒνƒ λ™κΈ°ν™”
```tsx
import { useState } from 'react';

function MyComponent() {
  const [state, setState] = useState({ submitted: false });
  const [isSubmitting, setIsSubmitting] = useState(false);

  const handleSubmit = async () => {
    setIsSubmitting(true);
    try {
      const response = await fetch('/api/submit', { method: 'POST' });
      if (response.ok) {
        setState({ ...state, submitted: true });
      }
    } catch (error) {
      console.error('Error submitting:', error);
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div>
      <h1>{state.submitted ? 'Form Submitted!' : 'Form Not Submitted'}</h1>
      <button onClick={handleSubmit} disabled={isSubmitting}>
        {isSubmitting ? 'Submitting...' : 'Submit'}
      </button>
    </div>
  );
}
```
β— **λ³µμ΅ν• μƒνƒ κ΄€λ¦¬**: μ„λ²„ μ‘λ‹µμ„ λ°›μ€ ν›„ μƒνƒλ¥Ό μλ™μΌλ΅ μ—…λ°μ΄νΈν•΄μ•Ό ν•κ³ , κ·Έ κ³Όμ •μ—μ„ **λ΅λ”© μƒνƒ μ²λ¦¬, μ—λ¬ μ²λ¦¬, μƒνƒ μ—…λ°μ΄νΈ**λ¥Ό λ¨λ‘ κ΄€λ¦¬ν•΄μ•Ό ν•λ―€λ΅ μ½”λ“κ°€ λ³µμ΅ν•΄μ§ μ μμµλ‹λ‹¤.   
β— **μƒνƒ λ™κΈ°ν™”μ μ–΄λ ¤μ›€**: μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ μƒνƒ λ™κΈ°ν™”λ¥Ό μλ™μΌλ΅ μ²λ¦¬ν•΄μ•Ό ν•λ―€λ΅ μ—λ¬κ°€ λ°μƒν•  κ°€λ¥μ„±μ΄ λ†’κ³ , μ½”λ“ μ¤‘λ³µμ΄ λ°μƒν•  μ μμµλ‹λ‹¤.

### π”Ή `useActionState`λ΅ κ°μ„ λ μ 
`useActionState`λ” μ΄λ¬ν• **λΉ„λ™κΈ° μ‘μ—… μ²λ¦¬**μ™€ **μƒνƒ λ™κΈ°ν™”**λ¥Ό μλ™μΌλ΅ μ²λ¦¬ν•΄μ¤λ‹λ‹¤. μ΄μ  ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„ μ•΅μ…μ„ νΈμ¶ν•κ³ , κ·Έ κ²°κ³Όλ΅ λ°μƒν•λ” μƒνƒ λ³€κ²½μ„ μλ™μΌλ΅ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤. μ„λ²„ μ•΅μ…μ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‰½κ² νΈμ¶ν•κ³ , μƒνƒλ¥Ό **μλ™μΌλ΅ λ™κΈ°ν™”**ν•΄μ£Όλ” λ°©μ‹μ…λ‹λ‹¤.

#### π§ μμ‹: `useActionState` μ‚¬μ©
```tsx
// μ„λ²„μ—μ„ μ‹¤ν–‰λλ” λΉ„λ™κΈ° ν•¨μ
async function myServerAction(state) {
  // μ„λ²„μ—μ„ λΉ„λ™κΈ° μ‘μ—…μ„ μ²λ¦¬ (μ: λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥)
  await fetch('/api/submit', { method: 'POST' });
  return { ...state, submitted: true };
}

function MyComponent() {
  // useActionState ν›… μ‚¬μ©
  const [state, formAction, isPending] = useActionState(myServerAction, { submitted: false });

  return (
    <div>
      <h1>{state.submitted ? 'Form Submitted!' : 'Form Not Submitted'}</h1>
      <button onClick={() => formAction(state)} disabled={isPending}>
        {isPending ? 'Submitting...' : 'Submit'}
      </button>
    </div>
  );
}
```
β”οΈ **μ„λ²„ μ•΅μ…μ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ§μ ‘ νΈμ¶**ν•μ—¬ **μλ™μΌλ΅ μƒνƒ λ™κΈ°ν™”**κ°€ μ΄λ£¨μ–΄μ§‘λ‹λ‹¤.  
β”οΈ **μƒνƒ κ΄€λ¦¬**μ™€ **λΉ„λ™κΈ° μ‘μ—… μ²λ¦¬**κ°€ ν›¨μ”¬ κ°„λ‹¨ν•΄μ Έ, **λ³µμ΅ν• λ΅μ§μ„ μλ™μΌλ΅ μ‘μ„±ν•  ν•„μ”**κ°€ μ—†μµλ‹λ‹¤.  
β”οΈ **λ΅λ”© μƒνƒ**(`isPending`)λ‚ **μ—λ¬ μ²λ¦¬** λ“±μ„ `useActionState`κ°€ μλ™μΌλ΅ κ΄€λ¦¬ν•΄ μ£ΌκΈ° λ•λ¬Έμ—, ν΄λΌμ΄μ–ΈνΈμ—μ„ λ³„λ„λ΅ λ΅μ§μ„ μ‘μ„±ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

<br>

- - -

<br>

## 3οΈβƒ£ `useActionState` μ‚¬μ© λ°©λ²•
### 1. κΈ°λ³Έ μ‚¬μ©λ²•
`useActionState`λ” μ„λ²„μ—μ„ μ‹¤ν–‰ν•  **λΉ„λ™κΈ° ν•¨μ**(`fn`)μ™€ μ΄κΈ° μƒνƒ(`initialState`)λ¥Ό λ°›μ•„ **μ„λ²„ μ•΅μ…**μ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‹¤ν–‰ν•©λ‹λ‹¤. μ΄ ν›…μ„ μ‚¬μ©ν•λ©΄ μ„λ²„ μ•΅μ…μ μƒνƒλ¥Ό **μλ™μΌλ΅ λ™κΈ°ν™”**ν•κ³ , **λ΅λ”© μƒνƒ**κΉμ§€ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
```tsx
const [state, formAction, isPending] = useActionState(fn, initialState, permalink?);
```
> π“ νλΌλ―Έν„°
>- `fn`: μ„λ²„μ—μ„ μ‹¤ν–‰ν•  **λΉ„λ™κΈ° ν•¨μ**μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈμ—μ„ μ΄ ν•¨μλ¥Ό νΈμ¶ν•λ©΄ μ„λ²„μ—μ„ ν•΄λ‹Ή μ‘μ—…μ΄ μ‹¤ν–‰λ©λ‹λ‹¤.
>- `initialState`: ν•΄λ‹Ή μƒνƒμ **μ΄κΈ°κ°’**μ„ μ„¤μ •ν•©λ‹λ‹¤.
>- `permalink` (μ„ νƒ μ‚¬ν•­): `true`λ΅ μ„¤μ •ν•λ©΄ μƒνƒκ°€ **URLμ— ν¬ν•¨**λμ–΄ **μƒνƒ κ³µμ  λ° λ¶λ§ν¬**κ°€ κ°€λ¥ν•©λ‹λ‹¤.


> π“ λ°ν™ κ°’
> - `state`: ν„μ¬ μƒνƒ κ°’μ…λ‹λ‹¤. μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ λ™κΈ°ν™”λ μƒνƒλ¥Ό μ κ³µν•©λ‹λ‹¤.
> - `formAction`: μ„λ²„ μ•΅μ…μ„ **νΈλ¦¬κ±°**ν•  μ μλ” ν•¨μμ…λ‹λ‹¤. μ΄ ν•¨μλ¥Ό νΈμ¶ν•μ—¬ μ„λ²„μ—μ„ λΉ„λ™κΈ° μ‘μ—…μ„ μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤.
> - `isPending`: μ„λ²„ μ•΅μ…μ΄ **μ§„ν–‰ μ¤‘μΈμ§€** μ—¬λ¶€λ¥Ό λ‚νƒ€λ‚΄λ” λ¶λ¦¬μ–Έ κ°’μ…λ‹λ‹¤.

### 2. μ„λ²„ μ•΅μ… μ •μ
μ„λ²„μ—μ„ μ‹¤ν–‰λ  **λΉ„λ™κΈ° ν•¨μ**λ¥Ό μ •μν•κ³ , μ΄λ¥Ό `useActionState`μ— μ „λ‹¬ν•μ—¬ μƒνƒλ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤.
```tsx
async function myServerAction(state) {
  // μ„λ²„μ—μ„ λΉ„λ™κΈ° μ‘μ—…μ„ μ²λ¦¬
  await fetch('/api/update-data', { method: 'POST' });
  return { ...state, updated: true };
}
```

### 3. ν΄λΌμ΄μ–ΈνΈμ—μ„ μƒνƒ λ³€κ²½
ν΄λΌμ΄μ–ΈνΈμ—μ„λ” `useActionState`λ¥Ό μ‚¬μ©ν•μ—¬ μ„λ²„ μ•΅μ…μ„ νΈλ¦¬κ±°ν•κ³ , μƒνƒλ¥Ό μ—…λ°μ΄νΈν•  μ μμµλ‹λ‹¤.
```tsx
<button onClick={() => formAction(state)}>Update</button>
```

### 4. λ΅λ”© μƒνƒ μ²λ¦¬
`isPending` κ°’μ„ μ‚¬μ©ν•μ—¬ μ„λ²„ μ•΅μ…μ΄ **μ§„ν–‰ μ¤‘μΈμ§€** μ—¬λ¶€λ¥Ό μ• μ μμΌλ©°, μ΄ κ°’μ„ ν†µν•΄ **λ΅λ”© UI**λ¥Ό ν‘μ‹ν•  μ μμµλ‹λ‹¤.
```tsx
{isPending && <p>Updating...</p>}
```

### 5. μƒνƒ λ™κΈ°ν™”
`useActionState`λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°μƒν• μƒνƒ λ³€κ²½μ„ μ„λ²„μ™€ μλ™μΌλ΅ λ™κΈ°ν™”ν•©λ‹λ‹¤.